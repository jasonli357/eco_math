# 常系数

## 一、特征方程法

### 1.1 适用情况

**常系数齐次线性微分方程**：

$$
a_n y^{(n)} + a_{n-1} y^{(n-1)} + \cdots + a_1 y' + a_0 y = 0
$$

### 1.2 步骤

1. **假设解的形式为指数函数**：

   $$
   y = e^{\lambda x}
   $$

2. **求解特征方程：**
   将 $y = e^{\lambda x}$ 代入微分方程中，得到特征方程。该方程通常是一个关于 $\lambda$ 的多项式方程，求解这个多项式得到特征值 $\lambda_1, \lambda_2, \ldots, \lambda_n$。

3. **构造通解：**
   根据特征方程的解（即特征值 $\lambda$），构造微分方程的通解：

   * 如果特征方程有 **不同的实特征值**（即 $(\lambda_1, \lambda_2, \ldots, \lambda_n)$ 都是不同的实数），那么解的形式为：

     $$
     y(x) = C_1 e^{\lambda_1 x} + C_2 e^{\lambda_2 x} + \cdots + C_n e^{\lambda_n x}
     $$

   * 如果特征方程有 **重根**（即某个特征值的代数重数大于1），那么解的形式会包含多项式项。例如，如果 $(\lambda_1)$ 是重根，则解的形式为：

     $$
     y(x) = (C_1 + C_2 x + \cdots + C_k x^{k-1}) e^{\lambda_1 x}
     $$

   * 如果特征方程有 **复数特征值**，例如 $(\lambda = \alpha \pm i\beta)$，则解的形式会包含正弦和余弦函数，通常使用欧拉公式将复数指数形式转化为三角函数形式：

     $$
     y(x) = e^{\alpha x} (C_1 \cos(\beta x) + C_2 \sin(\beta x))
     $$

     * 欧拉公式：$e^{\alpha \pm i \beta} = e^{\alpha} \left( \cos(\beta) \pm i \sin(\beta) \right)$



4. **应用初始条件：**
   如果给定了初始条件（如 $y(x_0) = y_0$ 和 $y'(x_0) = y_0'$），可以将这些条件代入通解，求解常数 $C_1, C_2, \ldots$。

--- -- -

## 二、待定系数法

### 2.1 适用情况

**常系数非齐次线性微分方程（非齐次项为特定形式）**：

$$
a_n y^{(n)} + a_{n-1} y^{(n-1)} + \cdots + a_1 y' + a_0 y = f(x)
$$

其中，$f(x)$ 是已知的非齐次项，且它的形式比较简单，常见的形式包括：

* 多项式，如 $f(x) = x^m$
* 指数函数，如 $f(x) = e^{kx}$
* 正弦或余弦函数，如 $f(x) = \sin(kx)$ 或 $f(x) = \cos(kx)$
* 多项式与指数、三角函数的乘积等。

### 2.2 步骤

1. **解齐次方程（可用特征方程法）：**
   首先求解对应的齐次方程：

   $$
   a_n y^{(n)} + a_{n-1} y^{(n-1)} + \cdots + a_1 y' + a_0 y = 0
   $$

   得到齐次方程的通解 $y_h(x)$。

2. **假设特解形式：**
   根据非齐次项 $f(x)$ 的形式，猜测特解 $y_p(x)$ 的形式。

   * $f(x) = x^m$，假设特解的形式为一个与 $f(x)$ 同型的多项式：$A_m x^m + A_{m-1} x^{m-1} + \cdots + A_1 x + A_0$
   * $f(x) = e^{kx}$，假设特解的形式为 $A e^{kx}$
   * $f(x) = \sin(kx)$ 或 $f(x) = \cos(kx)$，假设特解的形式为 $A \cos(kx) + B \sin(kx)$

3. **代入方程并确定系数：**
   将假设的特解代入原方程中，代入后得到一个包含未知系数的方程。通过比较两边的系数，解出这些未知系数。

4. **构造通解：**
   最终解是齐次解和特解的线性组合，即：

   $$
   y(x) = y_h(x) + y_p(x)
   $$

   其中，$(y_h(x))$ 是齐次方程的解，$(y_p(x))$ 是通过待定系数法求得的特解。

--- -- -

# 变系数（系数为关于 $x$ 的函数）

## 一、可分离变量法

### 1.1 适用范围

**一阶变系数齐次微分方程**：

$$
\frac{dy}{dx} = g(x)h(y)
$$

### 1.2 步骤


1. **将变量分离：**
   把微分方程的两边按照 $x$ 和 $y$ 分开，使得每一边只包含一个变量：

   $$
   \frac{1}{h(y)} dy = g(x) dx
   $$

2. **两边同时积分：**
   对两边同时积分，分别对 $(y)$ 和 $(x)$ 进行积分：

   $$
   \int \frac{1}{h(y)} dy = \int g(x) dx
   $$


--- -- -

## 二、积分因子法

### 2.1 适用情况

**一阶变系数非齐次微分方程**：

$$
\frac{dy}{dx} + P(x)y = Q(x)
$$

其中，$P(x)$ 和 $Q(x)$ 是已知的函数，$y$ 是未知函数。

### 2.2 步骤


1. **定义积分因子 $\mu(x)$：**

   $$
   \mu(x) = e^{\int P(x) dx}
   $$

2. **方程两边乘以积分因子：**

   $$
   \mu(x) \frac{dy}{dx} + \mu(x) P(x) y = \mu(x) Q(x)
   $$

   观察到，左边变成了一个**乘积的导数**，即：

   $$
   \frac{d}{dx} \left( \mu(x) y \right) = \mu(x) Q(x)
   $$

3. **两边对 $x$ 积分：**

   $$
   \int \frac{d}{dx} \left( \mu(x) y \right) dx = \int \mu(x) Q(x) dx
   $$

   这时左边积分后得到：

   $$
   \mu(x) y = \int \mu(x) Q(x) dx + C
   $$

4. **求解 y：**

   $$
   y = \frac{1}{\mu(x)} \left( \int \mu(x) Q(x) dx + C \right)
   $$


--- -- -

## 三、常数变易法

### 3.1 适用范围

**二阶变系数非齐次微分方程（要求对应的齐次方程能求出通解）**：

$$
y'' + p(x)y' + q(x)y = r(x)
$$

- 二阶变系数齐次方程没有通用解法，不一定能求出通解。
- 应该也适用于常系数的非齐次微分方程（替代上文的待定系数法）

### 3.2 步骤

1. **解齐次方程：**
   首先解与原方程相关的齐次方程：

   $$
   y'' + p(x)y' + q(x)y = 0
   $$

   得到两个线性无关的解 $y_1(x)$ 和 $y_2(x)$，它们构成齐次方程的通解：

   $$
   y_h(x) = C_1 y_1(x) + C_2 y_2(x)
   $$

2. **假设特解形式：**
   对于非齐次方程，常数变易法假设特解的形式是：

   $$
   y_p(x) = u_1(x) y_1(x) + u_2(x) y_2(x)
   $$

3. **求导并代入原方程：**
   对 $y_p(x)$ 进行求导：

   $$
   y_p'(x) = u_1'(x) y_1(x) + u_1(x) y_1'(x) + u_2'(x) y_2(x) + u_2(x) y_2'(x)
   $$

   $$
   y_p''(x) = u_1''(x) y_1(x) + 2 u_1'(x) y_1'(x) + u_1(x) y_1''(x) + u_2''(x) y_2(x) + 2 u_2'(x) y_2'(x) + u_2(x) y_2''(x)
   $$

   将这些导数代入原方程 $y'' + p(x)y' + q(x)y = r(x)$ 中。

4. **简化并求解：**
   通过代入，我们得到一个包含 $u_1(x)$ 和 $u_2(x)$ 以及它们的导数的方程。为了简化计算，通常假设：

   $$
   u_1'(x) y_1(x) + u_2'(x) y_2(x) = 0
   $$

   这样可以减少复杂度。然后将这个简化后的方程代入原方程中，得到关于 $u_1'(x)$ 和 $u_2'(x)$ 的方程，进而可以求解 $u_1(x)$ 和 $u_2(x)$。

5. **最终解：**
   通过解 $u_1(x)$ 和 $u_2(x)$，我们可以得到特解 $y_p(x)$，然后将其与齐次解 $y_h(x)$ 结合，得到原方程的通解：

   $$
   y(x) = y_h(x) + y_p(x) = C_1 y_1(x) + C_2 y_2(x) + u_1(x) y_1(x) + u_2(x) y_2(x)
   $$
